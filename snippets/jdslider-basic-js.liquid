{% javascript %}
(function () {

  /**
   * Initialize slider inside ONE section
   */
  function initSlider(section) {
    const slider = section.querySelector('.jdslider[data-tier="basic"]');
    if (!slider) return;

    // Prevent double init
    if (slider.swiper) return;

    const AUTOPLAY = slider.dataset.autoplay === 'true';
    const SPEED = parseInt(slider.dataset.speed) || 300;

    const swiper = new Swiper(slider, {
      effect: 'slide',
      loop: true,
      speed: SPEED,
      autoplay: AUTOPLAY ? { delay: 3000 } : false,

      navigation: {
        nextEl: slider.querySelector('.swiper-button-next'),
        prevEl: slider.querySelector('.swiper-button-prev'),
      },
    });

    // Store instance directly on DOM element
    slider.jdSwiper = swiper;
    console.log(slider.swiper);
  }

  /**
   * Destroy slider inside ONE section
   */
  function destroySlider(section) {
    const slider = section.querySelector('.jdslider[data-tier="basic"]');
    if (!slider || !slider.jdSwiper) return;

    slider.jdSwiper.destroy(true, true);
    slider.jdSwiper = null;
  }

  /**
   * Init on page load
   */
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.shopify-section').forEach(function (section) {
      initSlider(section);
    });
  });

  /**
   * Shopify Theme Editor Events
   */
  document.addEventListener('shopify:section:load', function (event) {
    initSlider(event.target);
  });

  document.addEventListener('shopify:section:unload', function (event) {
    destroySlider(event.target);
  });

})();
{% endjavascript %}